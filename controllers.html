<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Controllers &mdash; learning-robot-swarm-controllers 1.0.0 documentation</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono"><link rel="stylesheet" href="_static/typlog.css?v=0.7.3" type="text/css" />
  <link rel="stylesheet" href="_static/theme.css?v=0.7.3" type="text/css" />
      <link rel="index" title="Index" href="genindex.html"/>
      <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="learning-robot-swarm-controllers 1.0.0 documentation" href="index.html"/>
      <link rel="next" title="Imitation learning models" href="imitation-learning-models.html"/>
      <link rel="prev" title="Enki simulations" href="enki-simulations.html"/>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create', '');ga('send', 'pageview');</script>
  <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="learning-robot-swarm-controllers">
  <meta property="og:title" content="Controllers">
  <meta name="twitter:card" content="summary">
</head>
<body role="document" data-page="controllers">
  <header class="t-head">
    <div class="t-head_menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M64 384h384v-42.666H64V384zm0-106.666h384v-42.667H64v42.667zM64 128v42.665h384V128H64z"/></svg></div>
    <a class="t-head_logo" href="index.html">learning-robot-swarm-controllers
    </a>
  </header>
  <aside class="t-sidebar">
    <div class="t-sidebar_close">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M405 136.798L375.202 107 256 226.202 136.798 107 107 136.798 226.202 256 107 375.202 136.798 405 256 285.798 375.202 405 405 375.202 285.798 256z"/></svg>
    </div>
    <div class="inner">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Controllers</a><ul>
<li><a class="reference internal" href="#module-controllers.controllers_task1">Controllers Task 1</a></li>
<li><a class="reference internal" href="#module-controllers.controllers_task2">Controllers Task 2</a></li>
<li><a class="reference internal" href="#pid">PID</a><ul>
<li><a class="reference internal" href="#module-controllers.pid_tuning">PID tuning</a></li>
<li><a class="reference internal" href="#module-controllers.sensors_to_distances">Sensing to distances</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="enki-simulations.html" title="previous chapter">Enki simulations</a></li>
      <li>Next: <a href="imitation-learning-models.html" title="next chapter">Imitation learning models</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/controllers.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox">
  <form class="search" action="search.html" method="get">
    <div class="input-group">
      <input type="text" name="q" placeholder="Search" />
      <button type="submit">Go</button>
    </div>
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
    </div>
  </aside>
  <div class="t-content">
    <div class="t-body yue">
      
  <div class="section" id="controllers">
<h1>Controllers<a class="headerlink" href="#controllers" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-controllers.controllers_task1">
<span id="controllers-task-1"></span><h2>Controllers Task 1<a class="headerlink" href="#module-controllers.controllers_task1" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="controllers.controllers_task1.LearnedController">
<em class="property">class </em><code class="sig-prename descclassname">controllers.controllers_task1.</code><code class="sig-name descname">LearnedController</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">goal</span></em>, <em class="sig-param"><span class="n">N</span></em>, <em class="sig-param"><span class="n">net</span></em>, <em class="sig-param"><span class="n">net_input</span></em>, <em class="sig-param"><span class="n">communication</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#controllers.controllers_task1.LearnedController" title="Permalink to this definition">¶</a></dt>
<dd><p>The robots can be moved following a controller learned by a neural network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – name of the controller used (in this case omniscient)</p></li>
<li><p><strong>goal</strong> – task to perform (in this case distribute)</p></li>
<li><p><strong>N</strong> – number of agents in the simulation</p></li>
<li><p><strong>net</strong> – network to be used by the controller</p></li>
<li><p><strong>net_input</strong> – input of the network (between: prox_values, prox_comm and all_sensors)</p></li>
<li><p><strong>communication</strong> – states if the communication is used by the network</p></li>
<li><p><strong>kwargs</strong> – other arguments</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="controllers.controllers_task1.LearnedController.perform_control">
<code class="sig-name descname">perform_control</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state</span></em>, <em class="sig-param"><span class="n">dt</span></em><span class="sig-paren">)</span><a class="headerlink" href="#controllers.controllers_task1.LearnedController.perform_control" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the input sensing from the list of (7 or 14) proximity sensor readings, one for each sensor.
The first 5 entries are from frontal sensors ordered from left to right.
The last two entries are from rear sensors ordered from left to right.
In case of all sensors the first 7 values refers to <code class="docutils literal notranslate"><span class="pre">prox_values</span></code> and the following 7 to <code class="docutils literal notranslate"><span class="pre">prox_comm</span></code>.
Each value is normalised dividing it by 1000, that is the mean value of the sensors.</p>
<p>The obtained sensing is passed as input to the net and obtain the speed and the eventual communication to be transmitted.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Keep still the robots at the ends of the line and send for them alway 0 as message.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – object containing the agent information</p></li>
<li><p><strong>dt</strong> – control step duration</p></li>
</ul>
</dd>
<dt class="field-even">Return speed, communication</dt>
<dd class="field-even"><p>the velocity and the message to communicate</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="controllers.controllers_task1.ManualController">
<em class="property">class </em><code class="sig-prename descclassname">controllers.controllers_task1.</code><code class="sig-name descname">ManualController</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">goal</span></em>, <em class="sig-param"><span class="n">N</span></em>, <em class="sig-param"><span class="n">net_input</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#controllers.controllers_task1.ManualController" title="Permalink to this definition">¶</a></dt>
<dd><p>The robots are moved following a “distributed controller”, that is a simple proportional controller PID,
with P fixed to -0.01, whose goal is to align the robots by minimizing the difference between the values
​​recorded by the front and rear sensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – name of the controller used (in this case manual)</p></li>
<li><p><strong>goal</strong> – task to perform (in this case distribute)</p></li>
<li><p><strong>N</strong> – number of agents in the simulation</p></li>
<li><p><strong>net_input</strong> – input of the network (between: prox_values, prox_comm and all_sensors)</p></li>
<li><p><strong>kwargs</strong> – other arguments</p></li>
</ul>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><p><strong>p_distributed_controller</strong> – a simple proportional controller that returns the speed to apply</p>
</dd>
</dl>
<dl class="py method">
<dt id="controllers.controllers_task1.ManualController.compute_difference">
<code class="sig-name descname">compute_difference</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state</span></em><span class="sig-paren">)</span><a class="headerlink" href="#controllers.controllers_task1.ManualController.compute_difference" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Apply a small correction to the distance measured by the rear sensors since the front sensor used
is at a different x coordinate from the point to which the rear sensor of the robot that follows
points. This is because of the curved shape of the face of the Thymio.
The final difference is computed as follow:</p>
<div class="math notranslate nohighlight">
\[out = front - (back - correction)\]</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> – object containing the agent information</p>
</dd>
<dt class="field-even">Return out</dt>
<dd class="field-even"><p>the difference between the front and the rear distances</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="controllers.controllers_task1.ManualController.neighbors_distance">
<code class="sig-name descname">neighbors_distance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state</span></em><span class="sig-paren">)</span><a class="headerlink" href="#controllers.controllers_task1.ManualController.neighbors_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if there is a robot ahead using the infrared sensor 2 (front-front)
[2 and 9 in case of all sensors].
Check if there is a robot ahead using the infrared sensor 5 (back-left) and 6 (back-right)
[5, 6 and 12, 13 in case of all sensors].
The distance from the neighbors is computed using a mapping function obtained experimentally that converts the
intensities values contained in the sensor readings into distances.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The response values are actually intensities: the front correspond to the
frontal center sensor and the back to the mean of the response values of the rear sensors.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> – object containing the agent information</p>
</dd>
<dt class="field-even">Return back, front</dt>
<dd class="field-even"><p>back distance and front distance of the thymio from the others</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="controllers.controllers_task1.ManualController.perform_control">
<code class="sig-name descname">perform_control</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state</span></em>, <em class="sig-param"><span class="n">dt</span></em><span class="sig-paren">)</span><a class="headerlink" href="#controllers.controllers_task1.ManualController.perform_control" title="Permalink to this definition">¶</a></dt>
<dd><p>Keeping still the robots at the ends of the line, moves the others using the distributed controller,
setting the <code class="docutils literal notranslate"><span class="pre">target</span> <span class="pre">{left,</span> <span class="pre">right}</span> <span class="pre">wheel</span> <span class="pre">speed</span></code> each at the same value in order to moves the robot
straight ahead.
This distributed controller is a simple proportional controller <code class="docutils literal notranslate"><span class="pre">PID(5,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">max_out=16.6,</span> <span class="pre">min_out=-16.6)</span></code>
that takes in input the difference between the front and back distances measured by the agent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – object containing the agent information</p></li>
<li><p><strong>dt</strong> – control step duration</p></li>
</ul>
</dd>
<dt class="field-even">Return speed, communication</dt>
<dd class="field-even"><p>the velocity and the message to communicate</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="controllers.controllers_task1.OmniscientController">
<em class="property">class </em><code class="sig-prename descclassname">controllers.controllers_task1.</code><code class="sig-name descname">OmniscientController</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">goal</span></em>, <em class="sig-param"><span class="n">N</span></em>, <em class="sig-param"><span class="n">net_input</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#controllers.controllers_task1.OmniscientController" title="Permalink to this definition">¶</a></dt>
<dd><p>The robots can be moved also following an optimal “omniscient” controller. In this case, based on the poses of
the robots, the expert controller moves the robots at a constant speed, clipped to a minimum of -16.6 and
a maximum of 16.6, calculating the distance from the actual pose to the target one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – name of the controller used (in this case omniscient)</p></li>
<li><p><strong>goal</strong> – task to perform (in this case distribute)</p></li>
<li><p><strong>N</strong> – number of agents in the simulation</p></li>
<li><p><strong>net_input</strong> – input of the network (between: prox_values, prox_comm and all_sensors)</p></li>
<li><p><strong>kwargs</strong> – other arguments</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="controllers.controllers_task1.OmniscientController.linear_vel">
<code class="sig-name descname">linear_vel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state</span></em>, <em class="sig-param"><span class="n">constant</span><span class="o">=</span><span class="default_value">10</span></em><span class="sig-paren">)</span><a class="headerlink" href="#controllers.controllers_task1.OmniscientController.linear_vel" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the linear velocity as the <code class="docutils literal notranslate"><span class="pre">signed_distance</span></code> between the current and the goal position of the robot,
along the current theta of the robot. The final velocity is then multiplied by a constant value.</p>
<div class="math notranslate nohighlight">
\[velocity = constant * self.signed\_distance()\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – object containing the agent information</p></li>
<li><p><strong>constant</strong> – constant value (default: 10, but used also values as 1 or 4)</p></li>
</ul>
</dd>
<dt class="field-even">Return velocity</dt>
<dd class="field-even"><p>clipped linear velocity</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="controllers.controllers_task1.OmniscientController.perform_control">
<code class="sig-name descname">perform_control</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state</span></em>, <em class="sig-param"><span class="n">dt</span></em><span class="sig-paren">)</span><a class="headerlink" href="#controllers.controllers_task1.OmniscientController.perform_control" title="Permalink to this definition">¶</a></dt>
<dd><p>Move the robots using the omniscient controller by setting the target {left,right} wheel speed
each at the same value in order to moves the robot straight ahead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – object containing the agent information</p></li>
<li><p><strong>dt</strong> – control step duration</p></li>
</ul>
</dd>
<dt class="field-even">Return speed, 0</dt>
<dd class="field-even"><p>the computed speed and the message to communicate, fixed to 0, used only in case of
<code class="docutils literal notranslate"><span class="pre">prox_comm</span></code> or <code class="docutils literal notranslate"><span class="pre">all_sensors</span></code> net input</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-controllers.controllers_task2">
<span id="controllers-task-2"></span><h2>Controllers Task 2<a class="headerlink" href="#module-controllers.controllers_task2" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="controllers.controllers_task2.ManualController">
<em class="property">class </em><code class="sig-prename descclassname">controllers.controllers_task2.</code><code class="sig-name descname">ManualController</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">goal</span></em>, <em class="sig-param"><span class="n">N</span></em>, <em class="sig-param"><span class="n">net_input</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#controllers.controllers_task2.ManualController" title="Permalink to this definition">¶</a></dt>
<dd><p>Using the sensing of the robots, decide which robots are the first and the last and start sending a
communication message containing a value that is incremented by each robot that received it.
Each robot can receive two messages, if the count received from the right is higher than the one from the left,
then the agent is in the first half, otherwise it is in the second.
When the robot is sure about is position (it is able to understand on which side of the row it is, compared to
the mid of the line) then the robot can turn on the top led using different colours depending if it is
positioned in the first or second half of the row.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – name of the controller used (in this case manual)</p></li>
<li><p><strong>goal</strong> – task to perform (in this case colour)</p></li>
<li><p><strong>N</strong> – number of thymios in the simulation</p></li>
<li><p><strong>kwargs</strong> – other arguments</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="controllers.controllers_task2.ManualController.perform_control">
<code class="sig-name descname">perform_control</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state</span></em>, <em class="sig-param"><span class="n">dt</span></em><span class="sig-paren">)</span><a class="headerlink" href="#controllers.controllers_task2.ManualController.perform_control" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – object containing the agent information</p></li>
<li><p><strong>dt</strong> – control step duration</p></li>
</ul>
</dd>
<dt class="field-even">Return colour, communication</dt>
<dd class="field-even"><p>the colour and the message to communicate</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="controllers.controllers_task2.OmniscientController">
<em class="property">class </em><code class="sig-prename descclassname">controllers.controllers_task2.</code><code class="sig-name descname">OmniscientController</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">goal</span></em>, <em class="sig-param"><span class="n">N</span></em>, <em class="sig-param"><span class="n">net_input</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#controllers.controllers_task2.OmniscientController" title="Permalink to this definition">¶</a></dt>
<dd><p>The robots can turn on and colour the top led also following an optimal “omniscient” controller.
In this case, based on the position of the robots in the line, the omniscient control colour the robots in the first
half with a colour and the others with another.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – name of the controller used (in this case omniscient)</p></li>
<li><p><strong>goal</strong> – task to perform (in this case colour)</p></li>
<li><p><strong>N</strong> – number of agents in the simulation</p></li>
<li><p><strong>net_input</strong> – input of the network (between: prox_values, prox_comm and all_sensors)</p></li>
<li><p><strong>kwargs</strong> – other arguments</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="controllers.controllers_task2.OmniscientController.perform_control">
<code class="sig-name descname">perform_control</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state</span></em>, <em class="sig-param"><span class="n">dt</span></em><span class="sig-paren">)</span><a class="headerlink" href="#controllers.controllers_task2.OmniscientController.perform_control" title="Permalink to this definition">¶</a></dt>
<dd><p>Do not move the robots but just colour the robots belonging to the first half with a certain colour and
the other half with a different colour.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – object containing the agent information</p></li>
<li><p><strong>dt</strong> – control step duration</p></li>
</ul>
</dd>
<dt class="field-even">Return colour, communication</dt>
<dd class="field-even"><p>the colour and the message to communicate</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="pid">
<h2>PID<a class="headerlink" href="#pid" title="Permalink to this headline">¶</a></h2>
<p>Adapted from <a class="reference external" href="https://github.com/alessandro-giusti/teaching-notebooks/blob/master/robotics/04%20closedloopcontrol.ipynb">https://github.com/alessandro-giusti/teaching-notebooks/blob/master/robotics/04%20closedloopcontrol.ipynb</a></p>
<p>© 2020 Alessandro Giusti – 2020 Giorgia Adorni</p>
<span class="target" id="module-controllers.pid"></span><dl class="py class">
<dt id="controllers.pid.PID">
<em class="property">class </em><code class="sig-prename descclassname">controllers.pid.</code><code class="sig-name descname">PID</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Kp</span></em>, <em class="sig-param"><span class="n">Ki</span></em>, <em class="sig-param"><span class="n">Kd</span></em>, <em class="sig-param"><span class="n">min_out</span><span class="o">=</span><span class="default_value">- inf</span></em>, <em class="sig-param"><span class="n">max_out</span><span class="o">=</span><span class="default_value">inf</span></em><span class="sig-paren">)</span><a class="headerlink" href="#controllers.pid.PID" title="Permalink to this definition">¶</a></dt>
<dd><p>A PID controller that implements the following formula.</p>
<div class="math notranslate nohighlight">
\[K_p \epsilon + K_d \frac {d \epsilon}{d t} + K_i \int{\epsilon(t) dt}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Kp</strong> – apply a correction based on a proportional term</p></li>
<li><p><strong>Ki</strong> – apply a correction based on a integral term</p></li>
<li><p><strong>Kd</strong> – apply a correction based on a derivative term</p></li>
<li><p><strong>min_out=-float</strong><strong>(</strong><strong>&quot;inf&quot;</strong><strong>)</strong> – clip the speed to the minimum allowed velocity</p></li>
<li><p><strong>max_out=float</strong><strong>(</strong><strong>&quot;inf&quot;</strong><strong>)</strong><strong>)</strong> – clip the speed to the maximum allowed velocity</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="controllers.pid.PID.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">e</span></em>, <em class="sig-param"><span class="n">dt</span></em><span class="sig-paren">)</span><a class="headerlink" href="#controllers.pid.PID.step" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e</strong> – error</p></li>
<li><p><strong>dt</strong> – should be the time elapsed from the last time step was called</p></li>
</ul>
</dd>
<dt class="field-even">Return output</dt>
<dd class="field-even"><p>speed</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<div class="section" id="module-controllers.pid_tuning">
<span id="pid-tuning"></span><h3>PID tuning<a class="headerlink" href="#module-controllers.pid_tuning" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="controllers.pid_tuning.Thymio">
<em class="property">class </em><code class="sig-prename descclassname">controllers.pid_tuning.</code><code class="sig-name descname">Thymio</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">index</span></em>, <em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">i</span></em>, <em class="sig-param"><span class="n">d</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#controllers.pid_tuning.Thymio" title="Permalink to this definition">¶</a></dt>
<dd><p>Superclass: <cite>pyenki.Thymio2</cite> -&gt; the world update step will automatically call the Thymio <cite>controlStep</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – name of the agent</p></li>
<li><p><strong>index</strong> – index of the agents in the row</p></li>
<li><p><strong>p</strong> – proportional term of the PID controller</p></li>
<li><p><strong>i</strong> – integral term of the PID controller</p></li>
<li><p><strong>d</strong> – derivative term of the PID controller</p></li>
<li><p><strong>kwargs</strong> – other arguments</p></li>
</ul>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>initial_position</strong> – the initial position of the agent is set to None</p></li>
<li><p><strong>goal_position</strong> – the goal position of the agent is set to None</p></li>
<li><p><strong>goal_angle</strong> – the goal angle of the agent is set to None</p></li>
<li><p><strong>dictionary</strong> – the dictionary containing all the agent attributes is set to None</p></li>
<li><p><strong>colour</strong> – the colour of the agent is set to None</p></li>
<li><p><strong>p_distributed_controller</strong> – a simple proportional controller that returns the speed to apply</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="controllers.pid_tuning.Thymio.controlStep">
<code class="sig-name descname">controlStep</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dt</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#controllers.pid_tuning.Thymio.controlStep" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Perform one control step:</dt><dd><p>Compute the error as the difference between the goal and the actual position
and use it to compute the velocity of the robot through a proportional controller.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dt</strong> – control step duration</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="controllers.pid_tuning.Thymio.get_input_sensing">
<code class="sig-name descname">get_input_sensing</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#controllers.pid_tuning.Thymio.get_input_sensing" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return sensing</dt>
<dd class="field-odd"><p>the sensing perceived by the robot based on the net input</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="controllers.pid_tuning.main">
<code class="sig-prename descclassname">controllers.pid_tuning.</code><code class="sig-name descname">main</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">directory</span></em>, <em class="sig-param"><span class="n">P</span></em>, <em class="sig-param"><span class="n">I</span></em>, <em class="sig-param"><span class="n">D</span></em><span class="sig-paren">)</span><a class="headerlink" href="#controllers.pid_tuning.main" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>directory</strong> – directory were to save the images containing the step response</p></li>
<li><p><strong>P</strong> – proportional term of the PID controller</p></li>
<li><p><strong>I</strong> – integral term of the PID controller</p></li>
<li><p><strong>D</strong> – derivative term of the PID controller</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-controllers.sensors_to_distances">
<span id="sensing-to-distances"></span><h3>Sensing to distances<a class="headerlink" href="#module-controllers.sensors_to_distances" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="controllers.sensors_to_distances.Thymio">
<em class="property">class </em><code class="sig-prename descclassname">controllers.sensors_to_distances.</code><code class="sig-name descname">Thymio</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">index</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#controllers.sensors_to_distances.Thymio" title="Permalink to this definition">¶</a></dt>
<dd><p>Superclass: <cite>pyenki.Thymio2</cite> -&gt; the world update step will automatically call the Thymio <cite>controlStep</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – name of the agent</p></li>
<li><p><strong>index</strong> – index of the agents in the row</p></li>
<li><p><strong>kwargs</strong> – other arguments</p></li>
</ul>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>initial_position</strong> – the initial position of the agent is set to None</p></li>
<li><p><strong>dictionary</strong> – the dictionary containing all the agent attributes is set to None</p></li>
<li><p><strong>colour</strong> – the colour of the agent is set to None</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="controllers.sensors_to_distances.Thymio.controlStep">
<code class="sig-name descname">controlStep</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dt</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#controllers.sensors_to_distances.Thymio.controlStep" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Perform one control step:</dt><dd><p>Enable communication and send at each timestep a message.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dt</strong> – control step duration</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="controllers.sensors_to_distances.Thymio.get_input_sensing">
<code class="sig-name descname">get_input_sensing</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#controllers.sensors_to_distances.Thymio.get_input_sensing" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return sensing</dt>
<dd class="field-odd"><p>the sensing perceived by the robot based on the net input</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="controllers.sensors_to_distances.main">
<code class="sig-prename descclassname">controllers.sensors_to_distances.</code><code class="sig-name descname">main</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">distances</span></em>, <em class="sig-param"><span class="n">front_prox_values</span></em>, <em class="sig-param"><span class="n">back_prox_values</span></em>, <em class="sig-param"><span class="n">front_prox_comms</span></em>, <em class="sig-param"><span class="n">back_prox_comms</span></em>, <em class="sig-param"><span class="n">myt_quantity</span></em>, <em class="sig-param"><span class="n">min_distance</span></em><span class="sig-paren">)</span><a class="headerlink" href="#controllers.sensors_to_distances.main" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>distances</strong> – array containing the distances among the agents for each experiment</p></li>
<li><p><strong>front_prox_values</strong> – array containing the value of the frontal sensor using prox_values</p></li>
<li><p><strong>back_prox_values</strong> – array containing the value corresponding to the average of the rear sensor readings using prox_values</p></li>
<li><p><strong>front_prox_comms</strong> – array containing the value of the frontal sensor using prox_comm</p></li>
<li><p><strong>back_prox_comms</strong> – array containing the value corresponding to the average of the rear sensor readings using prox_comm</p></li>
<li><p><strong>myt_quantity</strong> – number of agents</p></li>
<li><p><strong>min_distance</strong> – length of the agents</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>
</div>

  <div class="t-pagination clearfix">
    <span>
      ← <a href="enki-simulations.html" title="Enki simulations">Enki simulations</a>
    </span>
    <span style="float:right">
      <a href="imitation-learning-models.html" title="Imitation learning models">Imitation learning models</a> →
    </span>
  </div>

    </div><footer class="t-foot">
    &copy; Copyright 2020, Giorgia Adorni.
    <br>
    A <a href="https://typlog.com/">typlog</a> <a href="https://github.com/typlog/sphinx-typlog-theme">sphinx theme</a>,
    designed by <a href="https://lepture.com/">Hsiaoming Yang</a>.
</footer>
  </div>
  <script>$(function(){$(".t-head_menu").on("click",function(){$("body").addClass("_expand")});$(".t-body").on("click",function(){$("body").removeClass("_expand")});$(".t-sidebar_close").on("click",function(){$("body").removeClass("_expand")});$("a.footnote-reference").on("click",function(e){e.preventDefault();var id=$(this).attr("href");var html=$(id).find("td.label + td").html();var w=Math.max(document.documentElement.clientWidth,window.innerWidth||0);var style="top:"+e.pageY+"px;";if(w>560){style+="width:480px;";if(e.pageX>240&&e.pageX+240<w){style+="left:"+(e.pageX-240)+"px;"}else if(e.pageX<=240){style+="left:20px;"}else{style+="right:20px;"}}showFootnote(html,style)});function showFootnote(html,style){var CONTENT_ID="typlog-footnote-content";var content=document.getElementById(CONTENT_ID);if(!content){content=document.createElement("div");content.id=CONTENT_ID;$(".t-body").append(content)}var MASK_ID="typlog-footnote-mask";var mask=document.getElementById(MASK_ID);if(!mask){mask=document.createElement("div");mask.id=MASK_ID;document.body.appendChild(mask);mask.addEventListener("click",function(){content.className="";mask.className=""})}content.innerHTML=html;content.setAttribute("style",style);content.className="_active";mask.className="_active"}function fetchGitHubRepo(repo){var url="https://api.github.com/repos/"+repo;$.getJSON(url,function(data){var counts=[+new Date,data.stargazers_count,data.forks_count];localStorage.setItem("gh:"+repo,JSON.stringify(counts));updateGitHubStats(counts[1],counts[2])})}function updateGitHubStats(stars,forks){$(".github_stars strong").text(stars);$(".github_forks strong").text(forks)}function initGitHub(url){if(!url){return}var repo=url.replace("https://github.com/","");var cache=localStorage.getItem("gh:"+repo);if(cache){try{var counts=JSON.parse(cache);updateGitHubStats(counts[1],counts[2]);var delta=new Date-counts[0];if(delta<0||delta>9e5){fetchGitHubRepo(repo)}}catch(error){fetchGitHubRepo(repo)}}else{fetchGitHubRepo(repo)}}initGitHub($(".github").attr("href"))});</script>
</body>
</html>