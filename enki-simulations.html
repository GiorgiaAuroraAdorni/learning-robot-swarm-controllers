<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Enki simulations &mdash; learning-robot-swarm-controllers 1.0.0 documentation</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono"><link rel="stylesheet" href="_static/typlog.css?v=0.7.3" type="text/css" />
  <link rel="stylesheet" href="_static/theme.css?v=0.7.3" type="text/css" />
      <link rel="index" title="Index" href="genindex.html"/>
      <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="learning-robot-swarm-controllers 1.0.0 documentation" href="index.html"/>
      <link rel="next" title="Controllers" href="controllers.html"/>
      <link rel="prev" title="Overview" href="overview.html"/>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create', '');ga('send', 'pageview');</script>
  <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="learning-robot-swarm-controllers">
  <meta property="og:title" content="Enki simulations">
  <meta name="twitter:card" content="summary">
</head>
<body role="document" data-page="enki-simulations">
  <header class="t-head">
    <div class="t-head_menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M64 384h384v-42.666H64V384zm0-106.666h384v-42.667H64v42.667zM64 128v42.665h384V128H64z"/></svg></div>
    <a class="t-head_logo" href="index.html">learning-robot-swarm-controllers
    </a>
  </header>
  <aside class="t-sidebar">
    <div class="t-sidebar_close">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M405 136.798L375.202 107 256 226.202 136.798 107 107 136.798 226.202 256 107 375.202 136.798 405 256 285.798 375.202 405 405 375.202 285.798 256z"/></svg>
    </div>
    <div class="inner">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Enki simulations</a><ul>
<li><a class="reference internal" href="#module-generate_simulation_data">Genaration of simulations</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="overview.html" title="previous chapter">Overview</a></li>
      <li>Next: <a href="controllers.html" title="next chapter">Controllers</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/enki-simulations.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox">
  <form class="search" action="search.html" method="get">
    <div class="input-group">
      <input type="text" name="q" placeholder="Search" />
      <button type="submit">Go</button>
    </div>
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
    </div>
  </aside>
  <div class="t-content">
    <div class="t-body yue">
      
  <div class="section" id="enki-simulations">
<h1>Enki simulations<a class="headerlink" href="#enki-simulations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-generate_simulation_data">
<span id="genaration-of-simulations"></span><h2>Genaration of simulations<a class="headerlink" href="#module-generate_simulation_data" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="generate_simulation_data.GenerateSimulationData">
<em class="property">class </em><code class="sig-prename descclassname">generate_simulation_data.</code><code class="sig-name descname">GenerateSimulationData</code><a class="headerlink" href="#generate_simulation_data.GenerateSimulationData" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="generate_simulation_data.GenerateSimulationData.check_dataset_conformity">
<em class="property">classmethod </em><code class="sig-name descname">check_dataset_conformity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">runs_dir</span></em>, <em class="sig-param"><span class="n">runs_img</span></em>, <em class="sig-param"><span class="n">title</span></em>, <em class="sig-param"><span class="n">dataset</span></em>, <em class="sig-param"><span class="n">net_input</span></em>, <em class="sig-param"><span class="n">communication</span></em><span class="sig-paren">)</span><a class="headerlink" href="#generate_simulation_data.GenerateSimulationData.check_dataset_conformity" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a scatter plot to check the conformity of the dataset.
The plot will show the distribution of the input sensing, in particular, as the difference between the front
sensor and the mean of the rear sensors, with respect to the output control of the datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>runs_dir</strong> – directory containing the simulation</p></li>
<li><p><strong>runs_img</strong> – directory containing the simulation images</p></li>
<li><p><strong>title</strong> – title of the plot</p></li>
<li><p><strong>dataset</strong> – name of the dataset</p></li>
<li><p><strong>net_input</strong> – input of the net between prox_values, prox_comm or all_sensors</p></li>
<li><p><strong>communication</strong> – states if the communication is used by the network</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="generate_simulation_data.GenerateSimulationData.generate_dict">
<em class="property">classmethod </em><code class="sig-name descname">generate_dict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">myt</span></em>, <em class="sig-param"><span class="n">n_sim</span></em>, <em class="sig-param"><span class="n">s</span></em>, <em class="sig-param"><span class="n">comm</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#generate_simulation_data.GenerateSimulationData.generate_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Save all the information of the agent in a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>myt</strong> – agent</p></li>
<li><p><strong>n_sim</strong> – index of the simulation</p></li>
<li><p><strong>s</strong> – index of the timestep</p></li>
<li><p><strong>comm</strong> – boolean, True if the dataset is generated using the learned model with communication</p></li>
</ul>
</dd>
<dt class="field-even">Return dictionary</dt>
<dd class="field-even"><ul class="simple">
<li><p>‘run’: n_sim,</p></li>
<li><p>‘timestep’: s,</p></li>
<li><p>‘name’: myt.name,</p></li>
<li><p>‘index’: myt.index,</p></li>
<li><p>‘myt_quantity’: myt.controller.N,</p></li>
<li><p>‘net_input’: myt.controller.net_input,</p></li>
<li><p>‘prox_values’: prox_values,</p></li>
<li><p>‘prox_comm’: utils.parse_prox_comm(prox_comm),</p></li>
<li><p>‘all_sensors’: all_sensors,</p></li>
<li><p>‘initial_position’: myt.initial_position,</p></li>
<li><p>‘position’: myt.position,</p></li>
<li><p>‘angle’: myt.angle,</p></li>
<li><p>‘goal_position’: myt.goal_position,</p></li>
<li><p>‘goal_angle’: myt.goal_angle,</p></li>
<li><p>‘motor_left_target’: myt.motor_left_target,</p></li>
<li><p>‘motor_right_target’: myt.motor_right_target,</p></li>
<li><p>‘goal_position_distance’: myt.goal_position[0] - myt.position[0],</p></li>
<li><p>‘goal_position_distance_absolute’: abs(myt.goal_position[0] - myt.position[0])</p></li>
<li><p>‘transmitted_comm’: communication transmitted two the neighbours</p></li>
<li><p>‘colour’: colour of the top led</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="generate_simulation_data.GenerateSimulationData.generate_simulation">
<em class="property">classmethod </em><code class="sig-name descname">generate_simulation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">run_dir</span></em>, <em class="sig-param"><span class="n">n_simulations</span></em>, <em class="sig-param"><span class="n">controller</span></em>, <em class="sig-param"><span class="n">myt_quantity</span></em>, <em class="sig-param"><span class="n">args</span></em>, <em class="sig-param"><span class="n">model_dir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">model</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">communication</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#generate_simulation_data.GenerateSimulationData.generate_simulation" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>run_dir</strong> – directory containing the simulation runs</p></li>
<li><p><strong>n_simulations</strong> – number of simulations to generate</p></li>
<li><p><strong>controller</strong> – controller to be used in the simulations</p></li>
<li><p><strong>model_dir</strong> – directory containing the model</p></li>
<li><p><strong>myt_quantity</strong> – number of agents</p></li>
<li><p><strong>args</strong> – arguments from command line</p></li>
<li><p><strong>model</strong> – model to be used</p></li>
<li><p><strong>communication</strong> – states if the communication is used by the network</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="generate_simulation_data.GenerateSimulationData.get_controller">
<em class="property">classmethod </em><code class="sig-name descname">get_controller</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">controller</span></em>, <em class="sig-param"><span class="n">controllers</span></em>, <em class="sig-param"><span class="n">goal</span></em>, <em class="sig-param"><span class="n">myt_quantity</span></em>, <em class="sig-param"><span class="n">net_input</span></em>, <em class="sig-param"><span class="n">communication</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">model</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">model_dir</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#generate_simulation_data.GenerateSimulationData.get_controller" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition important">
<p class="admonition-title">Important</p>
<p>This method has not yet been implemented for task 2.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>controller</strong> – name of the controller (between omniscient, manual and learned)</p></li>
<li><p><strong>controllers</strong> – reference to the controller class</p></li>
<li><p><strong>goal</strong> – task to perform (between colour ot distribute)</p></li>
<li><p><strong>myt_quantity</strong> – number of agents</p></li>
<li><p><strong>net_input</strong> – input of the net between prox_values, prox_comm or all_sensors</p></li>
<li><p><strong>communication</strong> – states if the communication is used by the network</p></li>
<li><p><strong>model</strong> – network to be used by the controller</p></li>
<li><p><strong>model_dir</strong> – directory containing the model</p></li>
</ul>
</dd>
<dt class="field-even">Return controller_factory</dt>
<dd class="field-even"><p>lambda function containing the controller to be used</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="generate_simulation_data.GenerateSimulationData.init_positions">
<em class="property">classmethod </em><code class="sig-name descname">init_positions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">myts</span></em>, <em class="sig-param"><span class="n">net_input</span></em>, <em class="sig-param"><span class="n">avg_gap</span></em>, <em class="sig-param"><span class="n">variate_pose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">min_distance</span><span class="o">=</span><span class="default_value">10.9</span></em>, <em class="sig-param"><span class="n">extension</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#generate_simulation_data.GenerateSimulationData.init_positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the agents, position them such as all x-axes are aligned.
Arrange the robots in a “single file” (all x-axes aligned) and within the proximity sensor range
(when running the extension of task 1 it is not mandatory that the robot are within the proximity sensor range,
since a random average gap is used).</p>
<p>The distance between the first and the last robot is usually computed as follow:</p>
<div class="math notranslate nohighlight">
\[(min\_distance + avg\_gap) * (myt\_quantity - 1)\]</div>
<p>In case of the extended task this quantity it is not initialised.</p>
<p>Usually, the distances among the robots are computed by drawing (myt_quantity - 1) real random gaps in using a normal
distribution with mean equal to the average gap and stdev fixed to 8. This values are clipped between 1 and the
<code class="docutils literal notranslate"><span class="pre">maximum_gap</span></code>. Then, the <code class="docutils literal notranslate"><span class="pre">minimum_distance</span></code> is added to all the distances, in order to move from the ICR
to the front of the thymio. The distances obtained are rescaled in such a way their sum corresponds to the
total gap that is known.
In case of the extended task the distances are obtained using the random average gap fixed and generating
random positions in the maximum range allowed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>myts</strong> – list containing all the agents and associated attributes</p></li>
<li><p><strong>net_input</strong> – input of the net between prox_values, prox_comm or all_sensors</p></li>
<li><p><strong>avg_gap</strong> – for the prox_values the default value is 8cm; for the prox_comm the default value is 25cm.
Can be also a random value, between 5 and 35, in case of the extended task.</p></li>
<li><p><strong>variate_pose</strong> – False by default, True only during the evaluation of the models when only one agent is used.</p></li>
<li><p><strong>min_distance</strong> – the minimum distance between two Thymio [wheel - wheel] is 10.9 cm,
that corresponds to the length of the agents.</p></li>
<li><p><strong>extension</strong> – True if is running task1_extension</p></li>
<li><p><strong>x</strong> – quantity of which variate the position along the x axis of the robot
(only during the model evaluation with variate_pose True)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="generate_simulation_data.GenerateSimulationData.run">
<em class="property">classmethod </em><code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_sim</span></em>, <em class="sig-param"><span class="n">myts</span></em>, <em class="sig-param"><span class="n">runs</span></em>, <em class="sig-param"><span class="n">complete_runs</span></em>, <em class="sig-param"><span class="n">world</span><span class="p">:</span> <span class="n">pyenki.pyenki.World</span></em>, <em class="sig-param"><span class="n">comm</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">gui</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">T</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">dt</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">tol</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.1</span></em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#generate_simulation_data.GenerateSimulationData.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the simulation as fast as possible or using the real time GUI.
Generate two different type of simulation data, one with all the thymios and the other without including the 2
thymios at the ends, but only the ones that have to move.
If all the robots have reached their target, stop the simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_sim</strong> – index of the simulation</p></li>
<li><p><strong>myts</strong> – list containing the agents</p></li>
<li><p><strong>runs</strong> – list containing all the data of the robots (except about the two robots at the beginning and
at the end of the row) in the simulations</p></li>
<li><p><strong>complete_runs</strong> – list containing all the data of the robots in the simulations</p></li>
<li><p><strong>world</strong> – enki world</p></li>
<li><p><strong>comm</strong> – variable that states if the communication is used</p></li>
<li><p><strong>gui</strong> – variable that states if use the gui</p></li>
<li><p><strong>T</strong> – duration of the simulation in seconds</p></li>
<li><p><strong>dt</strong> – control step duration – update timestep in seconds, should be below 1 (typically .02-.1)</p></li>
<li><p><strong>tol</strong> – tolerance used to verify if the robot reaches the target</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="generate_simulation_data.GenerateSimulationData.save_simulation">
<em class="property">classmethod </em><code class="sig-name descname">save_simulation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">complete_data</span></em>, <em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">runs_dir</span></em><span class="sig-paren">)</span><a class="headerlink" href="#generate_simulation_data.GenerateSimulationData.save_simulation" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>complete_data</strong> – list containing all the data of the robots in the simulations</p></li>
<li><p><strong>data</strong> – list containing all the data of the robots (except about the two robots at the beginning and
at the end of the row) in the simulations</p></li>
<li><p><strong>runs_dir</strong> – directory where to save the simulation runs</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="generate_simulation_data.GenerateSimulationData.setup">
<em class="property">classmethod </em><code class="sig-name descname">setup</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">controller_factory</span></em>, <em class="sig-param"><span class="n">myt_quantity</span></em>, <em class="sig-param"><span class="n">aseba</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#generate_simulation_data.GenerateSimulationData.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Set up the world as an unbounded world.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>controller_factory</strong> – if the controller is passed, load the learned network</p></li>
<li><p><strong>myt_quantity</strong> – number of robot in the simulation</p></li>
<li><p><strong>aseba</strong> – True</p></li>
</ul>
</dd>
<dt class="field-even">Return world, myts</dt>
<dd class="field-even"><p>world and the agents in the world</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="generate_simulation_data.GenerateSimulationData.update_dict">
<em class="property">classmethod </em><code class="sig-name descname">update_dict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">myt</span></em>, <em class="sig-param"><span class="n">s</span></em>, <em class="sig-param"><span class="n">comm</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#generate_simulation_data.GenerateSimulationData.update_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Updated data in the dictionary instead of rewrite every field to optimise performances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>myt</strong> – agent</p></li>
<li><p><strong>s</strong> – timestep</p></li>
<li><p><strong>comm</strong> – boolean, True if the dataset is generated using the learned model with communication</p></li>
</ul>
</dd>
<dt class="field-even">Return updated dictionary</dt>
<dd class="field-even"><p>updated dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="generate_simulation_data.GenerateSimulationData.verify_target">
<em class="property">classmethod </em><code class="sig-name descname">verify_target</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">myt</span></em>, <em class="sig-param"><span class="n">counter</span></em>, <em class="sig-param"><span class="n">dictionary</span></em>, <em class="sig-param"><span class="n">tol</span></em><span class="sig-paren">)</span><a class="headerlink" href="#generate_simulation_data.GenerateSimulationData.verify_target" title="Permalink to this definition">¶</a></dt>
<dd><p>Verify if the robot has reached the target goal.</p>
<p><em>It is always ensured that enough timesteps are performed, especially for the omniscient controller.</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>myt</strong> – agent</p></li>
<li><p><strong>counter</strong> – counter incremented when the robot has reached the goal</p></li>
<li><p><strong>dictionary</strong> – dictionary containing the agent information</p></li>
<li><p><strong>tol</strong> – tolerance</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>

  <div class="t-pagination clearfix">
    <span>
      ← <a href="overview.html" title="Overview">Overview</a>
    </span>
    <span style="float:right">
      <a href="controllers.html" title="Controllers">Controllers</a> →
    </span>
  </div>

    </div><footer class="t-foot">
    &copy; Copyright 2020, Giorgia Adorni.
    <br>
    A <a href="https://typlog.com/">typlog</a> <a href="https://github.com/typlog/sphinx-typlog-theme">sphinx theme</a>,
    designed by <a href="https://lepture.com/">Hsiaoming Yang</a>.
</footer>
  </div>
  <script>$(function(){$(".t-head_menu").on("click",function(){$("body").addClass("_expand")});$(".t-body").on("click",function(){$("body").removeClass("_expand")});$(".t-sidebar_close").on("click",function(){$("body").removeClass("_expand")});$("a.footnote-reference").on("click",function(e){e.preventDefault();var id=$(this).attr("href");var html=$(id).find("td.label + td").html();var w=Math.max(document.documentElement.clientWidth,window.innerWidth||0);var style="top:"+e.pageY+"px;";if(w>560){style+="width:480px;";if(e.pageX>240&&e.pageX+240<w){style+="left:"+(e.pageX-240)+"px;"}else if(e.pageX<=240){style+="left:20px;"}else{style+="right:20px;"}}showFootnote(html,style)});function showFootnote(html,style){var CONTENT_ID="typlog-footnote-content";var content=document.getElementById(CONTENT_ID);if(!content){content=document.createElement("div");content.id=CONTENT_ID;$(".t-body").append(content)}var MASK_ID="typlog-footnote-mask";var mask=document.getElementById(MASK_ID);if(!mask){mask=document.createElement("div");mask.id=MASK_ID;document.body.appendChild(mask);mask.addEventListener("click",function(){content.className="";mask.className=""})}content.innerHTML=html;content.setAttribute("style",style);content.className="_active";mask.className="_active"}function fetchGitHubRepo(repo){var url="https://api.github.com/repos/"+repo;$.getJSON(url,function(data){var counts=[+new Date,data.stargazers_count,data.forks_count];localStorage.setItem("gh:"+repo,JSON.stringify(counts));updateGitHubStats(counts[1],counts[2])})}function updateGitHubStats(stars,forks){$(".github_stars strong").text(stars);$(".github_forks strong").text(forks)}function initGitHub(url){if(!url){return}var repo=url.replace("https://github.com/","");var cache=localStorage.getItem("gh:"+repo);if(cache){try{var counts=JSON.parse(cache);updateGitHubStats(counts[1],counts[2]);var delta=new Date-counts[0];if(delta<0||delta>9e5){fetchGitHubRepo(repo)}}catch(error){fetchGitHubRepo(repo)}}else{fetchGitHubRepo(repo)}}initGitHub($(".github").attr("href"))});</script>
</body>
</html>